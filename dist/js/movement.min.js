let mouseStart,controlContainer,vp,floor,scrollDiff,scrollOffset,scrollDampening,isMouseDown=!1,zoomPercent=0;const scrollMin=-1100,scrollMax=600;function controlDown(o){isMouseDown=!0,mouseStart={x:o.x,y:o.y},controlContainer=o.target,controlContainer.classList.add("grabbing")}function controlUp(o){if(isMouseDown){isMouseDown=!1;let e={x:-(mouseStart.x-o.x),y:-(mouseStart.y-o.y)};controlContainer.classList.remove("grabbing");let t=parseFloat(getComputedStyle(controlContainer).getPropertyValue("--x")),l=parseFloat(getComputedStyle(controlContainer).getPropertyValue("--y"));controlContainer.style.setProperty("--x",t+e.x+"px"),controlContainer.style.setProperty("--y",l+e.y+"px")}}function initMovement(){vp=document.getElementById("viewport"),floor=document.getElementById("floor"),document.querySelector(".trigger").addEventListener("mousedown",(o=>{controlDown(o)})),scrollDiff=0,scrollOffset=0,scrollDampening=1,vp.addEventListener("mousewheel",(function(o){scrollZoom("mouse",o),setTransform3dZ()}),!1),scrollZoom(),setTransform3dZ()}function setScrollControl(o){zoomSlide.value=o}function scrollZoom(o=null,e=null){body.classList.contains("first")||("mouse"===o&&e?(e.preventDefault(),e.stopPropagation(),scrollDiff+=e.wheelDelta/scrollDampening):"slide"===o&&(scrollDiff=scale(zoomSlide.value,0,100,scrollMin,scrollMax),setTransform3dZ()),"slide"!==o&&(scrollDiff=minmax(scrollMin,scrollDiff,scrollMax),setScrollControl(scale(scrollDiff,scrollMin,scrollMax,0,100))))}function setTransform3dZ(){let o=scrollDiff+scrollOffset;vp.style.setProperty("--zoom",o+"px")}function minmax(o,e,t){return e<o?o:e>t?t:e}function scale(o,e,t,l,n){return(o-e)*(n-l)/(t-e)+l}document.addEventListener("mouseleave",(o=>{controlUp(o)})),document.addEventListener("mouseup",(o=>{controlUp(o)})),document.addEventListener("mousemove",(o=>{isMouseDown&&(controlUp(o),controlDown(o))}));